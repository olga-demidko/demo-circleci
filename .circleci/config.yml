# Use the latest 2.1 version of CircleCI pipeline process engine.
# See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1

# Define a job to be invoked later in a workflow.
# See: https://circleci.com/docs/2.0/configuration-reference/#jobs
orbs:
      nexploit: neuralegion/nexploit@2.0
jobs:
  build:
    machine: true
    steps:
    - nexploit/scan:
        scan_name: CircleCI Scan
        api_key: NEURALEGION_API_KEY
        discovery_types: 'crawler'
        crawlers: 'https://www.random1.org/,https://www.random2.org/'
        host_filters: 'random1.org,random2.org'
        headers: 'Content-Type: application/json;Keep-Alive: timeout=5, max=1000'
        type: appscan
        protocol: http


# Invoke jobs via workflows
# See: https://circleci.com/docs/2.0/configuration-reference/#workflows
workflows:
  your-workflow:
    jobs:
      - nexploit/retest-and-poll:
          scan_id: 7MeuiCeFc25WdJBamaaTG
          api_key: NEXPLOIT_API_KEY


